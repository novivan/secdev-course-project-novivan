| Поток/Элемент       | Угроза (STRIDE)                     | Риск | Контроль                                      | Ссылка на NFR | Проверка                          |
|---------------------|-------------------------------------|------|-----------------------------------------------|---------------|-----------------------------------|
| **F1** `/auth`      | **Spoofing** (подмена пользователя) | R1   | MFA + JWT с коротким TTL                     | NFR-01, NFR-05 | OWASP ZAP, негативные тесты       |
| **F2** `/features`  | **Tampering** (изменение фич)       | R2   | RBAC (`admin`-роль) + валидация схемы         | NFR-05        | OpenAPI контракт-тесты            |
| **F3** `/vote`      | **Repudiation** (отказ от голоса)   | R3   | Логи с `correlation_id` + подпись запросов    | NFR-07        | Аудит в ELK                       |
| **F4** (API → SVC)  | **DoS** (перегрузка сервиса)        | R4   | Rate-limiting (100 RPS/user) + circuit breaker | NFR-04        | Locust (20 RPS, p95 ≤ 200ms)      |
| **F6** SQL          | **Information Disclosure**          | R5   | Шифрование TLS + параметризованные запросы    | NFR-01        | SQLMap-сканирование               |
| **F7** Redis        | **Elevation of Privilege**          | R6   | Изоляция сети + HMAC подпись данных           | NFR-06        | Проникновение-тесты (Burp Suite)  |
